# äººä½“è§£æé¡¹ç›® (Human Parsing Project)

åŸºäºATRæ•°æ®é›†è®­ç»ƒçš„äººä½“éƒ¨ä½åˆ†å‰²æ¨¡å‹ï¼Œæä¾›å›¾åƒä¸­äººä½“éƒ¨ä½çš„è‡ªåŠ¨è¯†åˆ«ã€åˆ†å‰²å’Œæå–åŠŸèƒ½ï¼Œå¹¶åŒ…å«å®Œæ•´çš„WebæœåŠ¡æ¥å£ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¯ **ç²¾å‡†åˆ†å‰²**: è¯†åˆ«å’Œåˆ†å‰²18ä¸ªäººä½“éƒ¨ä½
- ğŸŒ **Webç•Œé¢**: å‹å¥½çš„å›¾å½¢ç”¨æˆ·ç•Œé¢
- ğŸ”Œ **REST API**: æä¾›ç¼–ç¨‹æ¥å£
- ğŸ“Š **å¯è§†åŒ–**: å®æ—¶æ˜¾ç¤ºåˆ†å‰²ç»“æœ
- ğŸ’¾ **å¯¼å‡ºåŠŸèƒ½**: å•ç‹¬ä¿å­˜æ¯ä¸ªèº«ä½“éƒ¨ä½
- ğŸš€ **é«˜æ€§èƒ½**: åŸºäºPyTorchå’ŒU-Netæ¶æ„

## æ”¯æŒçš„èº«ä½“éƒ¨ä½

1. èƒŒæ™¯ (background)
2. å¸½å­ (hat)
3. å¤´å‘ (hair)
4. å¤ªé˜³é•œ (sunglasses)
5. ä¸Šè¡£ (upper-clothes)
6. è£™å­ (skirt)
7. è£¤å­ (pants)
8. è¿è¡£è£™ (dress)
9. è…°å¸¦ (belt)
10. å·¦é‹ (left-shoe)
11. å³é‹ (right-shoe)
12. è„¸éƒ¨ (face)
13. å·¦è…¿ (left-leg)
14. å³è…¿ (right-leg)
15. å·¦è‡‚ (left-arm)
16. å³è‡‚ (right-arm)
17. åŒ… (bag)
18. å›´å·¾ (scarf)

## é¡¹ç›®ç»“æ„

```
project/
â”œâ”€â”€ dataset.py          # æ•°æ®é›†å¤„ç†æ¨¡å—
â”œâ”€â”€ train.py           # æ¨¡å‹è®­ç»ƒæ¨¡å—
â”œâ”€â”€ inference.py       # æ¨ç†é¢„æµ‹æ¨¡å—
â”œâ”€â”€ web_app.py         # WebæœåŠ¡æ¥å£
â”œâ”€â”€ main.py           # ä¸»å…¥å£è„šæœ¬
â”œâ”€â”€ requirements.txt   # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html    # Webç•Œé¢æ¨¡æ¿
â””â”€â”€ README.md         # é¡¹ç›®è¯´æ˜
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd project
pip install -r requirements.txt
```

æˆ–è€…ä½¿ç”¨ä¸»è„šæœ¬è‡ªåŠ¨å®‰è£…ï¼š

```bash
python main.py --setup
```

### 2. è®­ç»ƒæ¨¡å‹

```bash
python main.py --train
```

æˆ–è€…ç›´æ¥è¿è¡Œè®­ç»ƒè„šæœ¬ï¼š

```bash
python train.py
```

### 3. æµ‹è¯•æ¨ç†

```bash
python main.py --test
```

æˆ–è€…ç›´æ¥è¿è¡Œæ¨ç†è„šæœ¬ï¼š

```bash
python inference.py
```

### 4. å¯åŠ¨WebæœåŠ¡

```bash
python main.py --web
```

æˆ–è€…ç›´æ¥è¿è¡ŒWebåº”ç”¨ï¼š

```bash
python web_app.py
```

è®¿é—® http://localhost:5000 ä½¿ç”¨Webç•Œé¢

## ä½¿ç”¨æ–¹æ³•

### é€šè¿‡Webç•Œé¢

1. å¯åŠ¨WebæœåŠ¡
2. æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:5000
3. ä¸Šä¼ åŒ…å«äººç‰©çš„å›¾åƒ
4. æŸ¥çœ‹åˆ†å‰²ç»“æœå’Œæå–çš„èº«ä½“éƒ¨ä½

### é€šè¿‡APIæ¥å£

```python
import requests

# å‘é€å›¾åƒè¿›è¡Œé¢„æµ‹
url = "http://localhost:5000/api/predict"
files = {'image': open('path/to/image.jpg', 'rb')}
response = requests.post(url, files=files)

if response.json()['success']:
    result = response.json()
    print("é¢„æµ‹æˆåŠŸ!")
    print("å¯ç”¨çš„èº«ä½“éƒ¨ä½:", list(result['parts'].keys()))
else:
    print("é¢„æµ‹å¤±è´¥:", response.json()['error'])
```

### å¥åº·æ£€æŸ¥

```bash
curl http://localhost:5000/health
```

## æ•°æ®é›†

æœ¬é¡¹ç›®ä½¿ç”¨ATR (Atrous Spatial Pyramid Pooling) äººä½“è§£ææ•°æ®é›†ï¼ŒåŒ…å«ï¼š
- JPEGImages/: åŸå§‹å›¾åƒ
- SegmentationClassAug/: åˆ†å‰²æ ‡æ³¨æ©ç 

## æ¨¡å‹æ¶æ„

- **ä¸»å¹²ç½‘ç»œ**: ResNet34
- **åˆ†å‰²å¤´**: U-Net decoder
- **é¢„è®­ç»ƒæƒé‡**: ImageNet
- **è¾“å…¥å°ºå¯¸**: 512x512
- **è¾“å‡ºç±»åˆ«**: 18ä¸ªèº«ä½“éƒ¨ä½ + èƒŒæ™¯

## æ€§èƒ½æŒ‡æ ‡

- è®­ç»ƒè½®æ¬¡: 50 epochs
- æ‰¹æ¬¡å¤§å°: 8
- å­¦ä¹ ç‡: 1e-4
- ä¼˜åŒ–å™¨: Adam
- æŸå¤±å‡½æ•°: CrossEntropyLoss

## æ–‡ä»¶è¯´æ˜

- `dataset.py`: æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
- `train.py`: æ¨¡å‹è®­ç»ƒå’ŒéªŒè¯
- `inference.py`: å›¾åƒæ¨ç†å’Œç»“æœå¯è§†åŒ–
- `web_app.py`: Flask WebæœåŠ¡
- `main.py`: ç»Ÿä¸€å…¥å£è„šæœ¬

## å¼€å‘è¯´æ˜

### æ·»åŠ æ–°çš„èº«ä½“éƒ¨ä½

1. åœ¨ `dataset.py` çš„ `classes` åˆ—è¡¨ä¸­æ·»åŠ æ–°ç±»åˆ«
2. é‡æ–°è®­ç»ƒæ¨¡å‹
3. æ›´æ–°å‰ç«¯æ˜¾ç¤ºé€»è¾‘

### è‡ªå®šä¹‰æ¨¡å‹æ¶æ„

ä¿®æ”¹ `train.py` ä¸­çš„ `create_model()` æ–¹æ³•ï¼š

```python
self.model = smp.Unet(
    encoder_name='resnet50',      # æ›´æ¢ç¼–ç å™¨
    encoder_weights='imagenet',
    in_channels=3,
    classes=self.num_classes,
)
```

### è°ƒæ•´è®­ç»ƒå‚æ•°

ä¿®æ”¹ `train.py` ä¸­çš„è®­ç»ƒå‚æ•°ï¼š

```python
def train(self, train_loader, val_loader, num_epochs=100, save_dir='checkpoints'):
    # è°ƒæ•´è®­ç»ƒè½®æ¬¡å’Œå…¶ä»–å‚æ•°
```

## å¸¸è§é—®é¢˜

### Q: è®­ç»ƒæ—¶å‡ºç°å†…å­˜ä¸è¶³é”™è¯¯
A: å‡å°æ‰¹æ¬¡å¤§å°æˆ–å›¾åƒå°ºå¯¸

### Q: WebæœåŠ¡æ— æ³•å¯åŠ¨
A: æ£€æŸ¥ç«¯å£5000æ˜¯å¦è¢«å ç”¨ï¼Œæˆ–æ›´æ¢ç«¯å£

### Q: é¢„æµ‹ç»“æœä¸å‡†ç¡®
A: ç¡®ä¿è®­ç»ƒæ•°æ®å……è¶³ï¼Œæˆ–è°ƒæ•´æ¨¡å‹å‚æ•°

### Q: ä¾èµ–å®‰è£…å¤±è´¥
A: æ‰‹åŠ¨å®‰è£…ç‰¹å®šç‰ˆæœ¬çš„åŒ…ï¼Œæˆ–ä½¿ç”¨condaç¯å¢ƒ

## æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ä¾èµ–åŒ…æ˜¯å¦å®‰è£…å®Œæ•´
2. æ•°æ®é›†è·¯å¾„æ˜¯å¦æ­£ç¡®
3. æ¨¡å‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- æ”¯æŒ18ä¸ªäººä½“éƒ¨ä½åˆ†å‰²
- æä¾›Webç•Œé¢å’ŒAPIæ¥å£
- å®Œæ•´çš„è®­ç»ƒå’Œæ¨ç†æµç¨‹

---

**æ³¨æ„**: é¦–æ¬¡ä½¿ç”¨æ—¶è¯·å…ˆè®­ç»ƒæ¨¡å‹ä»¥è·å¾—æœ€ä½³æ•ˆæœã€‚æœªè®­ç»ƒçš„æ¨¡å‹å°†ä½¿ç”¨éšæœºæƒé‡ï¼Œé¢„æµ‹ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚
